---
title: "Asymmetric Loss"
subtitle: "DATA 5600 Introduction to Regression and Machine Learning for Analytics"
author: Marc Dotson
title-slide-attributes:
  data-background-color: "#0F2439"
format: 
  revealjs:
    theme: ../slides.scss  # Modified slides theme
    code-copy: true        # Show code blocks copy button
    slide-number: c/t      # Numbered slides current/total
    embed-resources: true  # Render to a single HTML file
execute:
  eval: false
  echo: true
jupyter: python3
---

## {background-color="#288DC2"}

### Get Started {.permanent-marker-font}

#### Last Time

- Project presentations

#### Preview

- Discuss the modeling workflow
- Review decision-making under uncertainty
- Extend symmetric loss to asymmetric loss

## {background-color="#D1CBBD"}

::: {.columns .v-center}
![](../../figures/workflow_plan-build.png){fig-align="center"}
:::

# Modeling Workflow

## What kind of machine learning?

:::: {.columns}

::: {.fragment .column width="33.33%"}
**Supervised learning**

::: {.incremental}
- Learn a **mapping function** from inputs to outputs $f: X \rightarrow Y$
- If the outputs are continuous, this learned mapping function is called **regression**
- If the outputs are discrete, this learned mapping function is called **classification**
:::
:::

::: {.fragment .column width="33.33%"}
**Unsupervised learning**

::: {.incremental}
- Learn groups and patterns in data without labeled outputs
- If we're grouping rows in a dataset, this is called **clustering**
- If we're grouping columns in a dataset, this is called **dimensionality reduction**
:::
:::

::: {.fragment .column width="33.33%"}
**Reinforcement learning**

::: {.incremental}
- An agent learns how to interact with its environment through trial and error
- The agent can take **actions** in its environment
- It receives **rewards or penalties** based on its actions
:::
:::

::::

## The mapping function is a *model*

We use models to **extract information** from data and inform decision-making under uncertainty

:::: {.columns}

::: {.column width="50%"}
::: {.fragment}
![](../../figures/models_all.png){fig-align="center"}
:::
:::

::: {.column width="50%"}
::: {.incremental}
- Why would we use an **interpretable model**?
- Why would we use an interpretable model if we only care about **prediction**?
- When would a flexible, **black-box model** be appropriate?
- Why would we need a **causal model**?
:::
:::

::::

## {background-color="#D1CBBD"}

::: {.columns .v-center}
![](../../figures/workflow_all.png){fig-align="center"}
:::

## {background-color="#D1CBBD" visibility="uncounted"}

::: {.columns .v-center}
![](../../figures/workflow_plan.png){fig-align="center"}
:::

## {background-color="#D1CBBD" visibility="uncounted"}

::: {.columns .v-center}
![](../../figures/workflow_build.png){fig-align="center"}
:::

## {background-color="#D1CBBD" visibility="uncounted"}

::: {.columns .v-center}
![](../../figures/workflow_explore.png){fig-align="center"}
:::

## {background-color="#D1CBBD" visibility="uncounted"}

::: {.columns .v-center}
![](../../figures/workflow_reconcile.png){fig-align="center"}
:::

## {background-color="#D1CBBD" visibility="uncounted"}

::: {.columns .v-center}
![](../../figures/workflow_fit.png){fig-align="center"}
:::

## {background-color="#D1CBBD" visibility="uncounted"}

::: {.columns .v-center}
![](../../figures/workflow_evaluate.png){fig-align="center"}
:::

## {background-color="#D1CBBD" visibility="uncounted"}

::: {.columns .v-center}
![](../../figures/workflow_predict.png){fig-align="center"}
:::

## {background-color="#D1CBBD" visibility="uncounted"}

::: {.columns .v-center}
![](../../figures/workflow_communicate.png){fig-align="center"}
:::

# With the benefit of your project experience, how does the modeling workflow help? {background-color="#006242"}

# Decision-Making Under Uncertainty

## Specify the business objective

Informing business decision-making requires a **clear objective**, and it is **your job** as a data analyst to make sure that **the objective is clearly specified**

::: {.fragment}
How do you make sure the objective is clearly specified?
:::

::: {.incremental}
- Communicate with domain experts and stakeholders
- Research the industry and relevant literature
- Learn the business model and the industry jargon
:::

## Formalize the objective as a function

A clearly specified objective can be translated into an objective function, which is typically a loss function

$$
\LARGE{\ell(a, s)}
$$

::: {.incremental}
- $a$ are **actions** we can take, which we have control over
- $s$ are **states of the world**, which we are uncertain about
- $\ell()$ is the **loss function**, which quantifies the **consequence** of taking action $a$ when the state of the world is $s$
:::

## Formalize the objective as a function

A clearly specified objective can be translated into an objective function, which is typically a loss function

$$
\LARGE{\color{grey}{\ell(a, }\theta\color{grey}{)}}
$$

- $a$ are **actions** we can take, which we have control over
- $s$ are **states of the world**, which we are uncertain about
- $\ell()$ is the **loss function**, which quantifies the **consequence** of taking action $a$ when the state of the world is $s$

::: {.fragment}
When do we use this loss function in the modeling workflow?
:::

## {background-color="#D1CBBD"}

::: {.columns .v-center}
![](../../figures/workflow_all.png){fig-align="center"}
:::

## {background-color="#D1CBBD"}

::: {.columns .v-center}
![](../../figures/workflow_all-decision.png){fig-align="center"}
:::

# How does framing regression and machine learning within a decision problem help? {background-color="#006242"}

# Extending Symmetric Loss

## Quadratic loss

**Quadratic loss** is the most common **symmetric** loss function (i.e., gains and losses are treated the same)

$$
\begin{aligned}
\LARGE{\ell(a, s)} & \hspace{3mm} \LARGE{= (a - s)^2}
\end{aligned}
$$

## Quadratic loss {visibility="uncounted"}

**Quadratic loss** is the most common **symmetric** loss function (i.e., gains and losses are treated the same)

$$
\begin{aligned}
\LARGE{\ell(a, \theta)} & \hspace{3mm} \LARGE{= (a - \theta)^2}
\end{aligned}
$$

## Quadratic loss {visibility="uncounted"}

**Quadratic loss** is the most common **symmetric** loss function (i.e., gains and losses are treated the same)

$$
\begin{aligned}
\LARGE{\ell(a, \theta)} & \hspace{3mm} \LARGE{= (a - \theta)^2} \\
& \hspace{3mm} \LARGE{= \sum_{i=1}^n (a_i - \theta_i)^2}
\end{aligned}
$$

## Quadratic loss {visibility="uncounted"}

**Quadratic loss** is the most common **symmetric** loss function (i.e., gains and losses are treated the same)

$$
\begin{aligned}
\LARGE{\ell(a, \theta)} & \hspace{3mm} \LARGE{= (a - \theta)^2} \\
& \hspace{3mm} \LARGE{= \sum_{i=1}^n (a_i - \theta_i)^2} \\
& \hspace{3mm} \LARGE{= \sum_{i=1}^n (\hat{y}_i - y_i)^2}
\end{aligned}
$$

## Quadratic loss {visibility="uncounted"}

**Quadratic loss** is the most common **symmetric** loss function (i.e., gains and losses are treated the same)

![](../../figures/lm_SSE_02.png){fig-align="center"}

# Point estimation is a type of decision problem

## Linear utility

**Linear utility** is the most common **symmetric** utility function (i.e., gains and losses are treated the same)

$$
\begin{aligned}
\LARGE{u(a, s)} & \hspace{3mm} \LARGE{= -\ell(a, s)}
\end{aligned}
$$

## Linear utility {visibility="uncounted"}

**Linear utility** is the most common **symmetric** utility function (i.e., gains and losses are treated the same)

$$
\begin{aligned}
\LARGE{u(a, \theta)} & \hspace{3mm} \LARGE{= -\ell(a, \theta)}
\end{aligned}
$$

## Linear utility {visibility="uncounted"}

**Linear utility** is the most common **symmetric** utility function (i.e., gains and losses are treated the same)

$$
\begin{aligned}
\LARGE{u(a, \theta)} & \hspace{3mm} \LARGE{= -\ell(a, \theta)} \\
& \hspace{3mm} \LARGE{= a + c \theta}
\end{aligned}
$$

## Linear utility {visibility="uncounted"}

**Linear utility** is the most common **symmetric** utility function (i.e., gains and losses are treated the same)

$$
\begin{aligned}
\LARGE{u(a, \theta)} & \hspace{3mm} \LARGE{= -\ell(a, \theta)} \\
& \hspace{3mm} \LARGE{= a + c \theta} \\
& \hspace{3mm} \LARGE{= \theta (a + c)}
\end{aligned}
$$

## Linear utility {visibility="uncounted"}

**Linear utility** is the most common **symmetric** utility function (i.e., gains and losses are treated the same)

$$
\begin{aligned}
\LARGE{u(a, \theta)} & \hspace{3mm} \LARGE{= -\ell(a, \theta)} \\
& \hspace{3mm} \LARGE{= a + c \theta} \\
& \hspace{3mm} \LARGE{= \theta (a + c)} \\
& \hspace{3mm} \LARGE{= \theta (p - c)}
\end{aligned}
$$

## Linear utility {visibility="uncounted"}

**Linear utility** is the most common **symmetric** utility function (i.e., gains and losses are treated the same)

$$
\begin{aligned}
\LARGE{u(a, \theta)} & \hspace{3mm} \LARGE{= -\ell(a, \theta)} \\
& \hspace{3mm} \LARGE{= a + c \theta} \\
& \hspace{3mm} \LARGE{= \theta (a + c)} \\
& \hspace{3mm} \LARGE{= \theta (p - c)} \\
& \hspace{3mm} \LARGE{= \mathcal{D} (p - c)}
\end{aligned}
$$

## Linear utility {visibility="uncounted"}

**Linear utility** is the most common **symmetric** utility function (i.e., gains and losses are treated the same)

![](../../figures/risk-neutral.png){fig-align="center"}

## Asymmetric utility

If a symmetric utility function implies **risk neutrality**, then an **asymmetric utility** function implies either **risk aversion** (i.e., losses loom larger than gains) or **risk seeking** (i.e., larger gains are worth the risk of larger losses)

::: {.fragment}
![](../../figures/risk-averse-neutral-taking.png){fig-align="center"}
:::

## Asymmetric loss

Asymmetric loss (or utility) functions are **more complicated** but **more realistic**

::: {.fragment}
What kind of business decisions would call for asymmetric loss (or utility)?
:::

::: {.incremental}
- Realtors may prefer overpricing to underpricing
- Inventory may prefer a surplus to a shortage
- Doctors may prefer false positives to false negatives
- Investors may prefer achieving gains to avoiding losses
:::

## Piecewise linear loss

**Piecewise linear loss** or **lin-lin loss** is a common **asymmetric** loss function (i.e., gains and losses are treated differently)

$$
\LARGE{\ell(a, s) = \begin{cases}
c_1 (s - a) & \text{if } a < s \\
c_2 (a - s) & \text{if } a \geq s
\end{cases}}
$$

## Piecewise linear loss {visibility="uncounted"}

**Piecewise linear loss** or **lin-lin loss** is a common **asymmetric** loss function (i.e., gains and losses are treated differently)

$$
\LARGE{\ell(a, \theta) = \begin{cases}
c_1 (\theta - a) & \text{if } a < \theta \\
c_2 (a - \theta) & \text{if } a \geq \theta
\end{cases}}
$$

::: {.fragment}
If $a$ is a point estimate $\hat{\theta}$, then $c_1$ is the **cost of underestimating** $\theta$, $c_2$ is the **cost of overestimating** $\theta$, and the loss function is symmetric if $c_1 = c_2$
:::

## {background-color="#006242"}

### Exercise 12 {.lato-font}

1. Review the syllabus and consider revisiting your data stack
2. Read the case and write how you might go about informing the decision (no more than one page), including specifying asymmetric loss (or utility) using the piecewise linear function
3. Submit your response as a PDF on Canvas

## {background-color="#288DC2"}

### Wrap Up {.permanent-marker-font}

#### Summary

- Discussed the modeling workflow
- Reviewed decision-making under uncertainty
- Extended symmetric loss to asymmetric loss

#### Next Time

- Review linear models
- Generalize linear models beyond regression

